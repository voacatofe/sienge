{
  "permissions": {
    "allow": [
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  COUNT(*) as total_contratos,\n  COUNT(CASE WHEN \"\"linkedCommissions\"\" IS NOT NULL AND \"\"linkedCommissions\"\" != ''null''::jsonb THEN 1 END) as com_comissoes,\n  COUNT(CASE WHEN \"\"linkedCommissions\"\" IS NOT NULL AND \"\"linkedCommissions\"\" != ''null''::jsonb AND jsonb_array_length(\"\"linkedCommissions\"\") > 0 THEN 1 END) as com_comissoes_validas\nFROM contratos_venda;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  COUNT(*) as total_contratos,\n  COUNT(CASE WHEN \"\"linkedCommissions\"\" IS NOT NULL AND \"\"linkedCommissions\"\" != ''null''::jsonb THEN 1 END) as com_comissoes,\n  COUNT(CASE WHEN jsonb_typeof(\"\"linkedCommissions\"\") = ''array'' THEN 1 END) as comissoes_array,\n  COUNT(CASE WHEN jsonb_typeof(\"\"linkedCommissions\"\") = ''object'' THEN 1 END) as comissoes_object\nFROM contratos_venda;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nCREATE OR REPLACE FUNCTION classify_commission_range(valor_comissao DECIMAL)\nRETURNS VARCHAR(30) AS $$\nBEGIN\n  IF valor_comissao IS NULL OR valor_comissao = 0 THEN\n    RETURN ''Sem Comissao'';\n  ELSIF valor_comissao < 100 THEN\n    RETURN ''Muito Baixo'';\n  ELSIF valor_comissao < 1000 THEN\n    RETURN ''Baixo'';\n  ELSIF valor_comissao < 10000 THEN\n    RETURN ''Medio'';\n  ELSIF valor_comissao < 50000 THEN\n    RETURN ''Alto'';\n  ELSE\n    RETURN ''Muito Alto'';\n  END IF;\nEND;\n$$ LANGUAGE plpgsql;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  COUNT(*) as total_contratos,\n  COUNT(CASE WHEN tem_comissao = true THEN 1 END) as com_comissao,\n  ROUND(AVG(valor_total_comissao), 2) as valor_medio_comissao,\n  ROUND(AVG(percentual_comissao_sobre_contrato), 2) as percentual_medio_comissao\nFROM contratos_venda;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  c.id,\n  c.number as numero_contrato,\n  c.valor_total_contrato,\n  c.tem_comissao,\n  c.valor_total_comissao,\n  c.faixa_valor_comissao,\n  c.percentual_comissao_sobre_contrato,\n  c.forma_pagamento_principal\nFROM contratos_venda c\nWHERE c.tem_comissao = true\n  AND c.valor_total_comissao > 50000\nORDER BY c.valor_total_comissao DESC\nLIMIT 5;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  ''Resumo Final da Normalizacao de Comissoes'' as titulo;\n\nSELECT \n  faixa_valor_comissao,\n  COUNT(*) as quantidade_contratos,\n  ROUND(AVG(valor_total_comissao), 2) as valor_medio_comissao,\n  ROUND(AVG(percentual_comissao_sobre_contrato), 2) as percentual_medio,\n  SUM(valor_total_comissao) as valor_total_faixa\nFROM contratos_venda \nGROUP BY faixa_valor_comissao\nORDER BY \n  CASE faixa_valor_comissao\n    WHEN ''Sem Comissao'' THEN 1\n    WHEN ''Muito Baixo'' THEN 2\n    WHEN ''Baixo'' THEN 3\n    WHEN ''Medio'' THEN 4\n    WHEN ''Alto'' THEN 5\n    WHEN ''Muito Alto'' THEN 6\n  END;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\\d contratos_venda\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  ''companyId'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"companyId\"\") as com_valor,\n  COUNT(*) - COUNT(\"\"companyId\"\") as sem_valor,\n  ROUND((COUNT(\"\"companyId\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''internalCompanyId'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"internalCompanyId\"\") as com_valor,\n  COUNT(*) - COUNT(\"\"internalCompanyId\"\") as sem_valor,\n  ROUND((COUNT(\"\"internalCompanyId\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''receivableBillId'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"receivableBillId\"\") as com_valor,\n  COUNT(*) - COUNT(\"\"receivableBillId\"\") as sem_valor,\n  ROUND((COUNT(\"\"receivableBillId\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''cancellationPayableBillId'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"cancellationPayableBillId\"\") as com_valor,\n  COUNT(*) - COUNT(\"\"cancellationPayableBillId\"\") as sem_valor,\n  ROUND((COUNT(\"\"cancellationPayableBillId\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''externalId'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"externalId\"\") as com_valor,\n  COUNT(*) - COUNT(\"\"externalId\"\") as sem_valor,\n  ROUND((COUNT(\"\"externalId\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nORDER BY percentual_preenchido;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  ''installmentPlan'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"installmentPlan\"\") as com_valor,\n  ROUND((COUNT(\"\"installmentPlan\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''paymentMethod'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"paymentMethod\"\") as com_valor,\n  ROUND((COUNT(\"\"paymentMethod\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''totalInstallments'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"totalInstallments\"\") as com_valor,\n  ROUND((COUNT(\"\"totalInstallments\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''paidInstallments'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"paidInstallments\"\") as com_valor,\n  ROUND((COUNT(\"\"paidInstallments\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''contractType'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"contractType\"\") as com_valor,\n  ROUND((COUNT(\"\"contractType\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''salesRepresentative'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"salesRepresentative\"\") as com_valor,\n  ROUND((COUNT(\"\"salesRepresentative\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nORDER BY percentual_preenchido;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nSELECT \n  ''correctionType'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"correctionType\"\") as com_valor,\n  ROUND((COUNT(\"\"correctionType\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''discountType'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"discountType\"\") as com_valor,\n  ROUND((COUNT(\"\"discountType\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''discountPercentage'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"discountPercentage\"\") as com_valor,\n  ROUND((COUNT(\"\"discountPercentage\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''interestType'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"interestType\"\") as com_valor,\n  ROUND((COUNT(\"\"interestType\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''interestPercentage'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"interestPercentage\"\") as com_valor,\n  ROUND((COUNT(\"\"interestPercentage\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nUNION ALL\nSELECT \n  ''remainingBalance'' as campo,\n  COUNT(*) as total_registros,\n  COUNT(\"\"remainingBalance\"\") as com_valor,\n  ROUND((COUNT(\"\"remainingBalance\"\")::decimal / COUNT(*)) * 100, 2) as percentual_preenchido\nFROM contratos_venda\nORDER BY percentual_preenchido;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nCREATE INDEX idx_contratos_venda_data_criacao_sienge ON contratos_venda(data_criacao_sienge);\nCREATE INDEX idx_contratos_venda_data_ultima_atualizacao_sienge ON contratos_venda(data_ultima_atualizacao_sienge);\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nALTER TABLE contratos_venda \nDROP COLUMN IF EXISTS installmentPlan,\nDROP COLUMN IF EXISTS salesRepresentative,\nDROP COLUMN IF EXISTS contractType;\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql -h 147.93.15.121 -p 5434 -U sienge_app -d sienge_data --set=sslmode=disable -c \"\nALTER TABLE contratos_venda \nDROP COLUMN IF EXISTS \"\"installmentPlan\"\",\nDROP COLUMN IF EXISTS \"\"salesRepresentative\"\",\nDROP COLUMN IF EXISTS \"\"contractType\"\";\")",
      "Bash(PGPASSWORD=kPnrGuFeJeuVprXzhhO2oLVE14f509KV psql:*)",
      "Bash(grep:*)",
      "Bash(python:*)",
      "Bash(npx prisma migrate dev:*)",
      "Bash(git add:*)",
      "Bash(psql:*)",
      "WebSearch",
      "Bash(npm run dev:*)",
      "Bash(npm run test:endpoints:*)",
      "Bash(xargs:*)"
    ],
    "deny": [],
    "ask": []
  },
  "enableAllProjectMcpServers": true,
  "enabledMcpjsonServers": ["task-master-ai", "puppeteer"]
}
